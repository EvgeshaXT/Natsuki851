# Natsuki851 - Дискорд бот на Disnake с поддержкой системы когов

## Установка

1. Клонирование репозитория:
```git clone https://github.com/EvgeshaXT/Natsuki851.git```

2. Переход в директорию Natsuki851:
```cd Natsuki851```

3. Создание виртуального окружения:
```python -m venv venv```

4. Активация виртуального окружения:
```venv/bin/activate```

6. Установка зависимостей:
```pip install -r requirements.txt```

7. Настройка .env файла:

- Скопируйте файл .env.example в .env с помощью одной команды:
```cp .env.example .env```

- Отредактируйте .env файл, добавив свой TOKEN:
```TOKEN='токен_вашего_дискорд_бота_здесь'```

Также вы можете добавить игнорируемые коги, которые будут добавлены в исключения при запуске бота. Может быть полезно при разработке собственных когов. Например:
```IGNORE_FILES='cog1.py, cog2.py'```


## Использование

Запуск бота (не забудьте активирировать виртуальное окружение перед запуском!):
```python main.py```

Внимание! Перед использованием убедительная просьба обратить внимание на то, что в проекте за основу префикса взят пинг именно нашего бота! ```(command_prefix=commands.when_mentioned)```
Данный префикс будет считаться стандартом для данного проекта.

Команды управления ботом (только для пользователей с правами администратора):

```@Natsuki851``` - Пинг бота

```@Natsuki851 load <cog_name>``` - Загрузить ког

```@Natsuki851 reload <cog_name>``` - Перезагрузить ког

```@Natsuki851 unload <cog_name>``` - Выгрузить ког

```@Natsuki851 cogs``` - Показать список всех когов

Доступные слеш-команды:

```/clear <count>``` - Удалить последние сообщения в чате (только для пользователей с правами администратора)

```/avatar <user>``` - Показать аватарку пользователя


Также в главном фалйе main.py в обработчике ошибок вы можете выбрать нужный параметр исходя из личных предпочтений. Бот может так и выводить предупреждения о несуществующих командах, так и игнорировать случайные триггеры. Просто удалите решётку с пробелом справа, чтобы бот мог выводить эти предупреждения.

Помимо основных команд, бот умеет поддерживать простой диалог и реагировать на сообщения пользователя. На данный момент бот имеет только 1 обработчик с пожеланием спокойной ночи.


## Автоматический запуск бота на Windows

Для автоматического запуска бота на Windows при запуске ПК вы можете использовать специальные скрипты. Здесь подготовлен один из сценариев как это можно реализовать.

1. Создайте файл auto.bat и вставьте в него следующий код:
```batch
@echo off
cd /d путь_к_вашему_проекту
call venv\Scripts\activate.bat
python main.py
exit
```

2. Замените "путь_к_вашему_проекту" на ваш действительный адрес директории Natsuki851. Например:
```batch
@echo off
cd /d D:\EvgeshaXT\MyProjects\Discord\Natsuki851
call venv\Scripts\activate.bat
python main.py
exit
```

3. Создайте ярлык и переместите его в директорию Автозагрузки. Для этого нажмите Win+R на клавиатуре и вставьте команду ```shell:startup```. Переместите данный ярлык в открывшуюся папку. 

Ваш бот будет запускаться при каждом запуске компьютера и вы сможете следить за его работой через консоль. При закрытии файла бот будет продолжать работать. Поэтому, если вам нужно принудительно его закрыть, вам необходимо завершить процесс Python через диспетчер задач.


## Структура проекта

Natsuki851/

├── cogs/ - Директория с когами

├── main.py - Основной файл бота

├── .env - Файл окружения

├── .env.example - Шаблон файла окружения

├── requirements.txt - Зависимости

└── README.md - Этот файл


## Модуль Euro Track Simulator 2 (Screenshots)
Данный модуль (cogs/ets2.py) создан для любителей игры Euro Track Simulator 2. Этот ког отслеживает папку со скриншотами из игры и автоматически отправляет все новые изображения в указанный текстовый канал Discord. Данный модуль не ограничен исключительно данной игрой, но ког будет иметь название игры, для которого первоначально был задуман автором. Перед использованием данного модуля необходимо настроить его под вашу систему в файле .env:

1. Путь к скриншотам: В файле .env измените переменную ```SCREENSHOT_PATH``` на абсолютный путь к папке скриншотов игры.

- Пример:
```SCREENSHOT_PATH = 'C:\Users\User\Documents\Euro Truck Simulator 2\screenshot'```

2. В этом же файле замените переменную ```CHANNEL_ID``` на ID дискорд канала, в который бот должен будет отправлять скриншоты. Подробный гайд где его взять, можете найти тут: [Инструкция от Discord](https://support.discord.com/hc/en-us/articles/206346498-Where-can-I-find-my-User-Server-Message-ID)

- Пример:
```CHANNEL_ID = 1234567891234567891```

3. Поведение при запуске: Настройте переменную ```SEND_EXISTING``` в фалйе .env в соответствии с вашими потребностями:

- True: При первом запуске кога все существующие или не отправленные скриншоты в папке будут отправлены в канал. Может вызвать флуд, если скриншотов много.

- False (по умолчанию): При запуске модуль пометит все существующие на момент запуска скриншоты как "отправленные" и будет отслеживать только новые файлы, созданные после его включения. Это рекомендуемая настройка, если в папке уже много старых скриншотов.

- Пример:
```SEND_EXISTING = False```

Если вы не хотите использовать данный модуль, добавьте значение 'ets2.py' в ```IGNORE_FILES``` файла .env, как это было написано в данном руководстве ранее.


## Разработка
Для создания своего собственного кога для бота, вам необходимо создать файл в папке cogs/ с расширением .py

Также вы можете использовать шаблон:
```python
import disnake
from disnake.ext import commands

class MyCog(commands.Cog):
    def __init__(self, bot):
        self.bot = bot

    @commands.slash_command()
    async def test(self, inter: disnake.ApplicationCommandInteraction):
        await inter.response.send_message("Всё работает!")

def setup(bot):
    bot.add_cog(MyCog(bot))
```